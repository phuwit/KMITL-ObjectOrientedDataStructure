"""
Chapter : 6 - item : 5 - ซ้อมตกนรก
ต้นไม้แห่งกามภูมิ หรือ งิ้ว
จากหนังสือไตรภูมิกถาได้บรรยายถึงต้นไม้แห่งกามภูมิแห่งนรกภูมิไว้ว่า
“…ฝูงคนอันทำชู้ด้วยเมียท่านก็ดี แลผู้หญิงอันมีผัวแล้วแลทำชู้จากผัวก็ดี คนฝูงนั้นตายไปเกิดในนรกนั้น นรกนั้นมีป่างิ้วป่าหนึ่งหลายต้นนักแล ต้นงิ้วนั้นต้นสูงได้ต้นแลโยชน์ แลหนามงิ้วนั้นเทียรย่อมเหล็กแดงเป็นเปลวลุกอยู่ แลหนามงิ้วนั้นยาวได้ 10 นิ้วมือ เป็นเปลวไฟลุกอยู่บ่ห่อนจะรู้ดับสักคาบแล... ฝูงยมบาลก็เอาหอกดาบหลาวแหลนอันคมเทียรย่อมเหล็กแดงแทงตีนผู้ชาย จำให้ขึ้นไปหาผู้หญิงว่าชู้สูอยู่บนปลายงิ้วโพ้น เร็ว อย่าอยู่ แลฝูงชายนั้นทนเจ็บบ่มิได้ จึงปีนขึ้นไปบนต้นงิ้วนั้น ครั้นว่าปีนขึ้นไปได้ หนามงิ้วนั้นบาดทั่วตนเขาขาดทุกแห่ง แล้วเป็นเปลวไฟไหม้ตนเขา...”
หากท่านที่ได้โจทย์นี้ ถือว่าท่านยังมีบุญ ก่อนที่ยมทูตจะพาตัวนักศึกษาไปลงนรก ยมทูตได้ทำโจทย์นี้ออกมา เพื่อให้คนที่มีบุญสัมพันธ์ได้รอด และช่วยให้ผ่านการทนทุกข์ทรมานในขุมนรกได้เร็วขึ้น นั้นก็คือการให้นักศึกษาฝึกซ้อมซ้อมปีนต้นงิ้วเอาไว้นั้นเอง ซึ่งหากปีนถึงยอดต้นงิ้วก็ถือว่ารอดจากขุมนรกนี้ได้สำเร็จ ทำให้นักศึกษารำลึกเอาไว้ว่า หากเจอในสถานการณ์จริงจะได้ปีนได้เร็ว และหลุดพ้นจากขุมนรกแห่งนี้ได้เขาก่อนไครนั้นเอง เพราะโจทย์ของยมทูตข้อนี้นั้นเอง
ลักษณะการปีน
    โดยต้นงิ้วที่นักศึกษาจะปีน จะถูกแบ่งเป็นข้อๆ โดยแต่ละข้อจะมีหนามให้จับและปีนขึ้นไป
        (โดยให้ถือว่าข้อเเรกของต้นไม้อยู่เหนือหัวของนักศึกษาที่จะปีน และถือว่าถ้าถึงข้อสุดท้ายถือว่าปีนผ่านสำเร็จ)
    แต่ต้นงิ้วก็ไม่ใช่ง่ายที่จะปีนขึ้นไปให้สำเร็จ เพราะจะมีบางข้อที่จะมีหนามที่ยาวจนเกินไป ทำให้ยากที่จะปีนขึ้น ทำให้นักศึกษาจะต้องเอื้อมมือไปจับหนามในข้อต่อๆไป ซึ่งมนุษย์เราจะเอื้อมไปจับข้อของต้นไม้เหนือหัวเราได้สูงสุดแค่ 3 ข้อ (1, 2 และ 3 ข้อเท่านั้น)
    เช่นเดียวกันนี้เป็นแค่การฝึก เพราะฉนั้นมนุษย์ย่อมมีอาการเหนื่อยได้หากปีนขึ้นต้นไม้ และจะยิ่งเหนื่อยเพิ่มมากขึ้นหาก ต้องเอื้อมไปจับข้อต้นไม้ที่ยิ่งอยู่สูงขึ้นไป ซึ่งมนุษย์ก็มีขีดจำกัดเช่นกัน ทำให้หากพลังงานหมดก่อนจะถือว่าปีนต้นไม้นั้นไม่สำเร็จนั้นเอง
สิ่งที่นักศึกษาต้องทำ
    รับ input ของข้อต้นไม้ทั้งหมดที่ต้นงิ้วมี (ไม่รับจำนวนทศนิยม และเป็นค่าติดลบไม่ได้)
    รับ input ของข้อต้นไม้ทั้งหมดที่มีหนามที่ยาวเกินไปเป็นอุปสรรค (ไม่รับจำนวนทศนิยม และเป็นค่าติดลบไม่ได้)
        หากไม่มีหนามจะระบุ 0
    รับ input ของพลังงานทั้งหมดที่นักศึกษาคนนั้นๆมี (รับจำนวนทศนิยมได้ และเป็นค่าติดลบไม่ได้)
    รับ input ของพลังงานในแต่ละข้อที่มนุษย์สามารถเอื้อมถึงได้ (พลังงานของ 1, 2 และ 3 ข้อ), (รับจำนวนทศนิยมได้ และเป็นค่าติดลบไม่ได้)
        หาก input มาจำนวน 3 ค่า จะเรียงตามข้อ
        หาก input มาจำนวน 2 ค่า จะเรียงกำหนดให้ข้อ 1,2 แต่ข้อที่ 3 กำหนดเป็น 0
        หาก input มาจำนวน 1 ค่า จะกำหนดให้ทุกข้อเป็นค่าค่านั้น
    แสดง output วิธีทั้งหมดที่จะสามารถรอดจากขุมนรกแห่งนี้ได้
ตัวอย่าง

Input :
Creating a simulated hell scenario : 5/2/6.5/1.5,2.5,3.5

อธิบาย input:
    5 	หมายถึง ต้นงิ้วต้นนี้มีทั้งหมด 5 ข้อ
    2	หมายถึง อุปสรรคหนามแหลมอยู่ข้อที่ 2
    6.5	หมายถึง นักศึกษาคนนั้นๆมีพลังงานทั้งหมด 6.5 จูล
    1.5,2.5,3.5	หมายถึง พลังงานที่ต้องใช้ในการเอื้อมไปยังต้นไม้ข้อแรกคือ 1.5 จูล,  พลังงานที่ต้องใช้ในการเอื้อมไปยังต้นไม้ข้อที่ 2 คือ 2.5 จูล และพลังงานที่ต้องใช้ในการเอื้อมไปยังต้นไม้ข้อที่ 3 คือ 3.5 จูล ตามลำดับ

Output :
The ways to escape is/are 4 ways

อธิบาย output:
วิธีการปีนขึ้นต้นงิ้วให้สำเร็จมีทั้งหมด 3 วิธีนั้นเอง นั้นคือ (1 = ข้อที่ 1)
~~วิธีที่ 1:	0->1->3->4->5 (ข้ามข้อที่ 2 เอื้อม 1,2,1,1 เอื้อม),~~
~~ใช้พลังงานทั้งหมด 1.5+2.5+1.5+1.5 = 7 (เกินพลังงานรวม (6.5) จึงตัดทิ้ง)~~
วิธีที่ 2:	0->1->3->5 (ข้ามข้อที่ 2 เอื้อม 1, 2, 2 ตามลำดับ),
ใช้พลังงานทั้งหมด 1.5+2.5+2.5 = 6.5
วิธีที่ 3:	0->1->4->5 (ข้ามข้อที่ 2 เอื้อม 1, 3, 1 ตามลำดับ),
ใช้พลังงานทั้งหมด 1.5+3.5+1.5 = 6.5
วิธีที่ 4:	0->3->4->5 (ข้ามข้อที่ 2 เอื้อม 3, 1, 1 ตามลำดับ),
ใช้พลังงานทั้งหมด 3.5+1.5+1.5 = 6.5
วิธีที่ 5:	0->3->5 (ข้ามข้อที่ 2 เอื้อม 3, 2 ตามลำดับ),
ใช้พลังงานทั้งหมด 3.5+2.5 = 6
ตอบ 4 วิธีนั้นเอง

เนื่องจากโจทย์ค่อนข้างสับสน ยมทูตจึงใจดีมอบคำใบ้ให้ดังนี้ “การปีนต้นงิ้วก็เหมือนกับการขึ้น… มันเหนื่อยเช่นเดียวกัน” โดยโจทย์ข้อนี้ไม่ได้กำหนด parameter ตายตัว นักศึกษาสามารถทำรูปแบบใดก็ได้ แต่อย่างน้อยต้องเป็น recursive เพราะยมทูตรู้ดีว่า "หากนักศึกษาตกนรกขึ้นมาจริงๆ นักศึกษาก็จะติดอยู่ในวังวน recursive(กรรม) เช่นเดียวกัน"

Creating a simulated hell scenario: 5/2/6.5/1.5,2.5,3.5
Height: 5
thorn At: ['2']
Max Tiredness: 6.5
Tiredness Values: {1: 1.5, 2: 2.5, 3: 3.5}
--------------------------------------------------
The ways to escape is/are 4 ways


Creating a simulated hell scenario: 4/0/0/0
Height: 4
thorn At: ['0']
Max Tiredness: 0.0
Tiredness Values: {1: 0.0, 2: 0.0, 3: 0.0}
--------------------------------------------------
The ways to escape is/are 7 ways


Creating a simulated hell scenario: 4/3/0/0
Height: 4
thorn At: ['3']
Max Tiredness: 0.0
Tiredness Values: {1: 0.0, 2: 0.0, 3: 0.0}
--------------------------------------------------
The ways to escape is/are 3 ways


Creating a simulated hell scenario: 4/0/2/1
Height: 4
thorn At: ['0']
Max Tiredness: 2.0
Tiredness Values: {1: 1.0, 2: 1.0, 3: 1.0}
--------------------------------------------------
The ways to escape is/are 3 ways


Creating a simulated hell scenario: 4/3/2/1
Height: 4
thorn At: ['3']
Max Tiredness: 2.0
Tiredness Values: {1: 1.0, 2: 1.0, 3: 1.0}
--------------------------------------------------
The ways to escape is/are 2 ways


Creating a simulated hell scenario: 6/6/60/6,6,6
Height: 6
thorn At: ['6']
Max Tiredness: 60.0
Tiredness Values: {1: 6.0, 2: 6.0, 3: 6.0}
--------------------------------------------------
The ways to escape is/are 0 ways


Creating a simulated hell scenario: 6/4,5/14/4,5,6
Height: 6
thorn At: ['4', '5']
Max Tiredness: 14.0
Tiredness Values: {1: 4.0, 2: 5.0, 3: 6.0}
--------------------------------------------------
The ways to escape is/are 1 ways


Creating a simulated hell scenario: 6/2,3,4/17/4.2,5.7,6.9
Height: 6
thorn At: ['2', '3', '4']
Max Tiredness: 17.0
Tiredness Values: {1: 4.2, 2: 5.7, 3: 6.9}
--------------------------------------------------
The ways to escape is/are 0 ways


Creating a simulated hell scenario: 6/1,3,5/66/11,22,33
Height: 6
thorn At: ['1', '3', '5']
Max Tiredness: 66.0
Tiredness Values: {1: 11.0, 2: 22.0, 3: 33.0}
--------------------------------------------------
The ways to escape is/are 1 ways


Creating a simulated hell scenario: 5/4,3,1/7.6/4.3,2.1,100
Height: 5
thorn At: ['4', '3', '1']
Max Tiredness: 7.6
Tiredness Values: {1: 4.3, 2: 2.1, 3: 100.0}
--------------------------------------------------
The ways to escape is/are 0 ways


Creating a simulated hell scenario: 5/1/500/200,400
Height: 5
thorn At: ['1']
Max Tiredness: 500.0
Tiredness Values: {1: 200.0, 2: 400.0, 3: 0}
--------------------------------------------------
The ways to escape is/are 3 ways
"""

from typing import Dict, List

MAX_REACH = 3

settings = input("Creating a simulated hell scenario: ").split("/")

height = int(settings.pop(0))
problematic_thorns = settings.pop(0).split(",")
max_energy = float(settings.pop(0))
tiredness: Dict[int, int | float] = {1: 0, 2: 0, 3: 0}
tiredness_raw = settings.pop(0).split(",")
if len(tiredness_raw) > 1:
    for i, value in enumerate(tiredness_raw):
        tiredness[i + 1] = float(value)
        continue
elif tiredness_raw != 0:
    tiredness_all = float(tiredness_raw.pop())
    tiredness = {1: tiredness_all, 2: tiredness_all, 3: tiredness_all}


print(
    f"""Height: {height}
thorn At: {problematic_thorns}
Max Tiredness: {max_energy}
Tiredness Values: {tiredness}"""
)
problematic_thorns = [int(n) for n in problematic_thorns]


def get_paths(current_level: int, used_energy: float):
    if used_energy > max_energy:
        # print(current_level, used_energy)
        return [False]

    if not current_level == 0 and current_level in problematic_thorns:
        return [False]

    if current_level >= height:
        if used_energy > max_energy or current_level > height:
            # print(False, current_level, used_energy)
            return [False]
        # print(True, current_level, used_energy)
        return [True]

    paths: List[bool] = []
    for step_size in range(1, MAX_REACH + 1):
        # print(f'level={current_level}, stepsize={step_size}')
        paths.extend(
            get_paths(
                current_level=(current_level + step_size),
                used_energy=(used_energy + tiredness[step_size]),
            )
        )

    return paths


valid_paths = sum(1 for i in get_paths(current_level=0, used_energy=0) if i is True)

print(f"""--------------------------------------------------
The ways to escape is/are {valid_paths} ways""")
